# Project Configuration
# This file contains all project-specific variables used in GitHub Actions workflows
#
# ðŸ”’ SECURITY NOTES:
# - This file is protected by CODEOWNERS (requires owner approval for changes)
# - Cost-critical values (max_instances, memory, etc.) can be overridden via GitHub Secrets
# - Recommended: Set MAX_INSTANCES and MEMORY as repository secrets for extra protection
#
# WHEN CLONING THIS REPO:
# 1. Update all values below to match your new project
# 2. Set GitHub Secrets to override sensitive/cost-critical values
# 3. Enable branch protection rules to enforce CODEOWNERS
#
# Copy this file to other projects and update the values as needed

project:
  # Google Cloud Platform Configuration
  gcp:
    project_id: "product-one-477118"
    region: "europe-west2"
    service_account: "github-actions-cloudrun@product-one-477118.iam.gserviceaccount.com"

    # Artifact Registry Configuration
    artifact_registry:
      repository: "dottie-api-images"
      location: "europe-west2"
    
    # Cloud Run Configuration
    # ðŸ’° COST CONTROL: Override via GitHub Secrets for extra protection
    # Set secrets: CLOUD_RUN_MAX_INSTANCES, CLOUD_RUN_MEMORY, CLOUD_RUN_CPU
    cloud_run:
      region: "europe-west2"
      memory: "512Mi"           # Override with secret: CLOUD_RUN_MEMORY
      cpu: "1"                  # Override with secret: CLOUD_RUN_CPU
      min_instances: 0          # COST SAVINGS: Scale to zero when idle (prevents 24/7 charges)
      max_instances: 3          # ðŸ”’ COST CONTROL: Override with secret: CLOUD_RUN_MAX_INSTANCES
      timeout: "60s"
      concurrency: 100

  # Firebase Configuration
  firebase:
    project_id: "product-one-477118"
    # Note: Hosting URLs are auto-derived from project_id:
    # - Main: https://{project_id}.web.app
    # - Branches: https://{project_id}--{channel-id}.web.app
    # Note: Hosting URLs are auto-derived from project_id:
    # - Main: https://{project_id}.web.app
    # - Branches: https://{project_id}--{channel-id}.web.app

  # Application Configuration
  app:
    name: "dottie"
    api:
      entry_point: "apps/api"
      service_name_pattern: "dottie-api-{branch}"
      health_endpoint: "/api/health"
      # Note: CORS origins are auto-derived from FIREBASE_PROJECT_ID at runtime:
      # - https://{project_id}.web.app
      # - https://{project_id}--*.web.app
      # Note: CORS origins are auto-derived from FIREBASE_PROJECT_ID at runtime:
      # - https://{project_id}.web.app
      # - https://{project_id}--*.web.app
      build_command: "npm install --production"
      test_command: "npm test"
      start_command: "npm start"
    
    web:
      entry_point: "apps/web"
      build_command: "npm run build"
      test_command: "npm test"
      dist_directory: "dist"
      environment_prefix: "VITE_"

# GitHub Secrets Used (for documentation)
# These secrets must be configured in your GitHub repository:
secrets:
  required:
    - GCP_SA_KEY                    # Google Cloud service account JSON key
    - GCP_PROJECT_ID                # Google Cloud project ID (should match project.gcp.project_id)
    - FIREBASE_SERVICE_ACCOUNT_KEY  # Firebase service account JSON key
  optional:
    - GITHUB_TOKEN                  # Automatically provided by GitHub Actions